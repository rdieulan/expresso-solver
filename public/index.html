<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Expresso Solver — UI</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { font-family: system-ui, Arial; max-width: 1100px; margin: 18px auto; }
    pre { background:#f6f8fa; padding:12px; border-radius:6px; overflow:auto }
    .badge-action { font-size:0.9rem; padding:0.5em 0.6em; }
    .card-range { max-height:320px; overflow:auto; }
  </style>
</head>
<body>
  <div class="container py-3">
    <div class="d-flex align-items-center mb-3">
      <h1 class="h4 mb-0">Expresso Solver — UI</h1>
      <small class="text-muted ms-3">(préflop)</small>
    </div>

    <div class="row">
      <div class="col-lg-5">
        <div class="card mb-3">
          <div class="card-body">
            <form id="frm">

              <div class="mb-2">
                <label class="form-label">Profil actif</label>
                <div class="d-flex gap-2">
                  <select id="profileSelect" class="form-select"></select>
                  <button id="btnRefreshProfiles" type="button" class="btn btn-outline-secondary">↻</button>
                </div>
                <div class="form-text">Choisis le profil de ranges à utiliser (GTO / Exploit / personnalisé)</div>
              </div>

              <div class="mb-2">
                <label class="form-label">Nombre de joueurs</label>
                <select id="players" class="form-select">
                  <option value="2">2</option>
                  <option value="3" selected>3</option>
                </select>
              </div>

              <div class="mb-2">
                <label class="form-label">Profondeur (bb)</label>
                <input id="depth" type="number" class="form-control" value="10" min="5" max="15" />
              </div>

              <div class="mb-2">
                <label class="form-label">Position hero</label>
                <select id="position" class="form-select"><option>BTN</option><option>SB</option><option>BB</option></select>
              </div>

              <div class="mb-2">
                <label class="form-label">Main</label>
                <input id="hand" type="text" class="form-control" value="AKs" placeholder="ex: AhKs, AKs, AK" />
                <div class="form-text">Formats acceptés: AhKs, AKs, AK, a k s, TsTh, etc.</div>
              </div>

              <div class="form-check mb-2">
                <input id="showRange" class="form-check-input" type="checkbox" />
                <label class="form-check-label">Afficher la range complète</label>
              </div>

              <div class="mb-2">
                <label class="form-label">Format</label>
                <select id="format" class="form-select"><option value="text">text</option><option value="json">json</option></select>
              </div>

              <div class="d-flex gap-2 mb-2">
                <button class="btn btn-primary" type="submit">Décider</button>
                <button id="btnClear" type="button" class="btn btn-outline-secondary">Effacer</button>
              </div>

              <hr />

              <div>
                <label class="form-label">Uploader un fichier de ranges (JSON)</label>
                <input id="rangesFile" type="file" accept="application/json" class="form-control mb-2" />
                <div class="mb-2 d-flex gap-2 align-items-center">
                  <input id="uploadProfileName" class="form-control form-control-sm" placeholder="Nom du profil (ex: exploit-v2)" />
                  <button id="btnUpload" type="button" class="btn btn-sm btn-outline-primary">Uploader</button>
                  <div id="uploadStatus" class="align-self-center text-muted small">Aucun fichier</div>
                </div>
                <div class="form-text">Si tu fournis un nom, le profil sera enregistré sous <code>data/profiles/&lt;nom&gt;.json</code> et activé.</div>
              </div>

            </form>
          </div>
        </div>

        <div class="card">
          <div class="card-body">
            <h6 class="card-title">Aide rapide</h6>
            <ul class="small mb-0">
              <li>Le serveur renvoie les décisions pour <code>FirstIn</code>, <code>VsOpen</code> et <code>VsShove</code> pour chaque vilain.</li>
              <li>Cliquer <em>Décider</em> appelle <code>/api/decide</code> côté serveur.</li>
              <li>Uploader un fichier JSON remplace les ranges chargées en mémoire (validation côté serveur).</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="col-lg-7">
        <div id="resultArea">
          <div class="card mb-3">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start">
                <div>
                  <h6 class="mb-1">Sortie</h6>
                  <div id="metaLine" class="text-muted small">Aucune requête effectuée.</div>
                </div>
                <div>
                  <button id="btnCopy" class="btn btn-sm btn-outline-primary" title="Copier le JSON" style="display:none">Copier</button>
                </div>
              </div>

              <div id="content" class="mt-3">
                <pre id="out">Aucune requête effectuée.</pre>
              </div>
            </div>
          </div>

          <div id="visual" style="display:none">
            <div class="card mb-3">
              <div class="card-body">
                <h6>Range utilisée</h6>
                <div id="rangeCard" class="card-range small text-monospace"></div>
              </div>
            </div>

            <div class="card">
              <div class="card-body">
                <h6>Décisions</h6>
                <div id="decisionsList"></div>
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>

  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="/app.js"></script>
</body>
</html>
